<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ú–µ–Ω—é –∏–∑ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–∞ ‚Äî –ø–∏—Ç–∞–Ω–∏–µ –¥–ª—è —ç–Ω–µ—Ä–≥–∏–∏ –∏ –π–æ–≥–∏</title>

  <style>
    :root{
      --bg:#f6faf7;
      --card:#ffffff;
      --text:#1f2937;
      --muted:#6b7280;
      --line:#e7efe9;

      --green:#6fbf8a;
      --green-2:#2f6f4e;
      --green-soft:#e9f6ee;

      --shadow: 0 10px 24px rgba(0,0,0,.06);
      --r:18px;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:var(--bg);
      color:var(--text);
    }
    .wrap{
      max-width: 980px;
      margin: 0 auto;
      padding: 22px 16px 60px;
    }

    .top{
      display:flex;
      align-items:flex-start;
      gap:14px;
      margin-bottom:16px;
    }
    .logo{
      width:44px;height:44px;
      border-radius:14px;
      background: linear-gradient(145deg, #dff3e7, #f7fff9);
      box-shadow: var(--shadow);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:22px;
    }
    h1{
      margin:0;
      font-size:34px;
      color:#2f4f3f;
      letter-spacing:-.3px;
    }
    .subtitle{
      margin:8px 0 0;
      color:var(--muted);
      font-size:15px;
      line-height:1.5;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:16px;
      margin-top:16px;
    }
    @media (max-width: 920px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      background:var(--card);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      border:1px solid rgba(0,0,0,.03);
      padding:18px;
    }
    .card h2{
      margin:0 0 14px;
      font-size:26px;
      letter-spacing:-.2px;
    }
    .card h3{
      margin:16px 0 10px;
      font-size:18px;
    }
    .hint{
      color:var(--muted);
      font-size:14px;
      margin: 0 0 14px;
      line-height:1.5;
    }

    .formGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:14px;
    }
    @media (max-width: 700px){
      .formGrid{ grid-template-columns: 1fr; }
    }

    label{
      display:block;
      font-size:13px;
      color:var(--muted);
      margin: 0 0 6px;
    }

    input, select, textarea{
      width:100%;
      padding: 12px 12px;
      border-radius: 14px;
      border:1px solid #e6e6e6;
      background:#fbfbfb;
      outline:none;
      font-size:16px;
    }
    input:focus, select:focus, textarea:focus{
      border-color:#bfe8cf;
      box-shadow: 0 0 0 4px rgba(111,191,138,.15);
      background:#fff;
    }
    textarea{
      min-height: 92px;
      resize: vertical;
    }

    .btn{
      width:100%;
      margin-top: 14px;
      border: none;
      border-radius: 16px;
      padding: 16px 14px;
      font-size: 18px;
      font-weight: 700;
      cursor:pointer;
      background: var(--green);
      color:#fff;
      transition: transform .04s ease, filter .2s ease;
    }
    .btn:active{ transform: translateY(1px); }
    .btn:hover{ filter: brightness(0.98); }

    .btn.secondary{
      background: #e9f6ee;
      color: #2f6f4e;
      font-weight: 700;
    }

    .row{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin-top:10px;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border-radius: 999px;
      background: var(--green-soft);
      color: var(--green-2);
      font-size: 14px;
      font-weight: 700;
    }

    .divider{
      height:1px;
      background: var(--line);
      margin: 14px 0;
    }

    .resultWrap{
      margin-top: 14px;
      display:none;
    }

    .resultCard{
      background: #f7fbf8;
      border:1px solid #dff1e7;
      border-radius: 16px;
      padding: 14px;
    }

    .bigStat{
      display:flex;
      gap: 10px;
      align-items: baseline;
      flex-wrap: wrap;
    }
    .bigStat b{
      font-size: 18px;
    }
    .kcal{
      font-size: 26px;
      font-weight: 900;
      color: var(--green-2);
    }
    .muted{
      color:var(--muted);
      font-size: 14px;
      margin-top: 6px;
      line-height: 1.5;
    }

    .mealList{
      margin: 10px 0 0;
      padding: 0;
      list-style: none;
      display:grid;
      gap:10px;
    }

    .mealItem{
      background:#fff;
      border:1px solid #e9f3ee;
      border-radius: 14px;
      padding: 12px 12px;
      display:flex;
      gap:10px;
      align-items:flex-start;
    }
    .mealIcon{
      width:34px; height:34px;
      border-radius: 12px;
      background: var(--green-soft);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:18px;
      flex: 0 0 auto;
    }
    .mealText{
      flex:1 1 auto;
    }
    .mealTitle{
      font-weight: 900;
      margin-bottom: 3px;
    }
    .mealSub{
      color: var(--muted);
      font-size: 14px;
    }

    .tabs{
      display:flex;
      gap:10px;
      margin-top: 14px;
      flex-wrap: wrap;
    }
    .tabBtn{
      border:1px solid #dfeee6;
      background:#fff;
      color:#2f4f3f;
      border-radius: 999px;
      padding: 10px 14px;
      font-weight: 800;
      cursor:pointer;
    }
    .tabBtn.active{
      background: var(--green-soft);
      border-color: #bfe8cf;
      color: var(--green-2);
    }

    .menuBox{
      margin-top: 12px;
      display:none;
    }

    .menuDay{
      background:#fff;
      border:1px solid #e8f3ec;
      border-radius: 16px;
      padding: 14px;
      margin-bottom: 12px;
    }
    .menuDay h4{
      margin:0 0 8px;
      font-size: 16px;
      letter-spacing: -.2px;
    }
    .menuDay .dayHint{
      color: var(--muted);
      font-size: 13px;
      margin: 0 0 10px;
    }
    .menuLines{
      margin:0;
      padding-left: 18px;
      display:grid;
      gap:8px;
    }
    .menuLines li{
      line-height: 1.45;
    }

    .finePrint{
      margin-top: 14px;
      color: var(--muted);
      font-size: 12px;
      line-height: 1.5;
    }

    .fileRow{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
    }

    .fakeAiBox{
      background:#f7fbf8;
      border:1px dashed #bfe8cf;
      border-radius: 16px;
      padding: 12px;
      color:#2f6f4e;
      font-size: 14px;
      display:none;
    }

    .smallNote{
      font-size: 13px;
      color: var(--muted);
      margin: 6px 0 0;
    }

    .mini{
      font-size: 13px;
      color: var(--muted);
    }

    .twoBtns{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 10px;
    }
    .twoBtns .btn{
      margin-top: 0;
      width:auto;
      padding: 12px 14px;
      font-size: 15px;
      border-radius: 999px;
    }

    .warn{
      display:none;
      margin-top: 12px;
      background: #fff7ed;
      border: 1px solid #fed7aa;
      color: #9a3412;
      padding: 12px;
      border-radius: 14px;
      font-size: 14px;
      line-height: 1.5;
    }
  </style>
</head>

<body>
  <div class="wrap">

    <div class="top">
      <div class="logo">ü•ó</div>
      <div>
        <h1>–ú–µ–Ω—é –∏–∑ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–∞</h1>
        <p class="subtitle">
          –ú—è–≥–∫–∏–π —Ä–∞—Å—á—ë—Ç –ø–∏—Ç–∞–Ω–∏—è –¥–ª—è –∂–µ–Ω—â–∏–Ω 30‚Äì45 –ª–µ—Ç, –ø—Ä–∞–∫—Ç–∏–∫—É—é—â–∏—Ö –π–æ–≥—É 1‚Äì2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é.
          –¶–µ–ª—å ‚Äî —Å–Ω–∏–∂–µ–Ω–∏–µ –≤–µ—Å–∞ –±–µ–∑ —Å—Ç—Ä–µ—Å—Å–∞: –ø–æ–Ω—è—Ç–Ω—ã–µ –ø–æ—Ä—Ü–∏–∏, –∫–∞–ª–æ—Ä–∏–∏ –ø–æ –ø—Ä–∏—ë–º–∞–º –ø–∏—â–∏ –∏ –≥–æ—Ç–æ–≤–∞—è –Ω–µ–¥–µ–ª—è.
        </p>
      </div>
    </div>

    <div class="grid">

      <!-- –õ–ï–í–û: –†–ê–°–ß–ï–¢ + –ú–ï–ù–Æ -->
      <div class="card">
        <h2>–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç</h2>
        <p class="hint">–ó–∞–ø–æ–ª–Ω–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Üí –Ω–∞–∂–º–∏ ¬´–†–∞—Å—Å—á–∏—Ç–∞—Ç—å¬ª ‚Üí –ø–æ–ª—É—á–∏—à—å —Å—É—Ç–æ—á–Ω—É—é –Ω–æ—Ä–º—É –∏ –∫—Ä–∞—Å–∏–≤—É—é —Ä–∞–∑–±–∏–≤–∫—É –ø–æ –ø—Ä–∏—ë–º–∞–º –ø–∏—â–∏.</p>

        <div class="formGrid">
          <div>
            <label for="weight">–í–µ—Å (–∫–≥)</label>
            <input id="weight" type="number" inputmode="decimal" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: 72" />
          </div>

          <div>
            <label for="height">–†–æ—Å—Ç (—Å–º)</label>
            <input id="height" type="number" inputmode="decimal" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: 168" />
          </div>

          <div>
            <label for="age">–í–æ–∑—Ä–∞—Å—Ç</label>
            <input id="age" type="number" inputmode="numeric" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: 36" />
          </div>

          <div>
            <label for="gender">–ü–æ–ª</label>
            <select id="gender">
              <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
              <option value="male">–ú—É–∂—Å–∫–æ–π</option>
            </select>
          </div>

          <div>
            <label for="activity">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</label>
            <select id="activity">
              <option value="1.35">–ô–æ–≥–∞ 1‚Äì2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é</option>
              <option value="1.55">–ô–æ–≥–∞ 3‚Äì4 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é</option>
              <option value="1.75">–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</option>
            </select>
          </div>

          <div>
            <label for="goal">–¶–µ–ª—å</label>
            <select id="goal">
              <option value="0.90">–ú—è–≥–∫–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –≤–µ—Å–∞</option>
              <option value="1.00">–ë–∞–ª–∞–Ω—Å –∏ —ç–Ω–µ—Ä–≥–∏—è</option>
              <option value="1.05">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º—ã</option>
            </select>
          </div>
        </div>

        <button class="btn" id="calcBtn" type="button">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>

        <div class="warn" id="warnBox">–ó–∞–ø–æ–ª–Ω–∏ –≤–µ—Å, —Ä–æ—Å—Ç –∏ –≤–æ–∑—Ä–∞—Å—Ç (—á–∏—Å–ª–∞), –∏ –ø–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑.</div>

        <div class="resultWrap" id="resultWrap">
          <div class="resultCard">
            <div class="bigStat">
              <b>–°—É—Ç–æ—á–Ω–∞—è –Ω–æ—Ä–º–∞:</b> <span class="kcal" id="dailyKcal">‚Äî</span> <span>–∫–∫–∞–ª</span>
            </div>
            <div class="muted" id="bjuText">–û—Ä–∏–µ–Ω—Ç–∏—Ä –ë–ñ–£: ‚Äî</div>

            <div class="divider"></div>

            <b>–ü—Ä–∏–º–µ—Ä —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ –ø—Ä–∏—ë–º–∞–º –ø–∏—â–∏:</b>
            <ul class="mealList" id="mealSplit">
              <!-- –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JS -->
            </ul>

            <div class="muted" id="toneLine">–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –π–æ–≥–∏ –∏ –º—è–≥–∫–æ–≥–æ —Å–Ω–∏–∂–µ–Ω–∏—è –≤–µ—Å–∞.</div>

            <div class="tabs">
              <button class="tabBtn active" id="tabDay" type="button">–ü–æ–∫–∞–∑–∞—Ç—å 1 –¥–µ–Ω—å</button>
              <button class="tabBtn" id="tabWeek" type="button">–ü–æ–∫–∞–∑–∞—Ç—å –Ω–µ–¥–µ–ª—é</button>
            </div>

            <div class="menuBox" id="dayBox"></div>
            <div class="menuBox" id="weekBox"></div>
          </div>
        </div>
      </div>

      <!-- –ü–†–ê–í–û: –£–ú–ù–û–ï –ú–ï–ù–Æ –ò–ó –ü–†–û–î–£–ö–¢–û–í -->
      <div class="card">
        <h2>–£–º–Ω–æ–µ –º–µ–Ω—é –∏–∑ –ø—Ä–æ–¥—É–∫—Ç–æ–≤</h2>
        <p class="hint">
          –î–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞: <b>–∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</b> (–¥–µ–º–æ-—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ) –∏–ª–∏ <b>–≤–≤–µ—Å—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç—ã –≤—Ä—É—á–Ω—É—é</b>.
          –¶–µ–ª—å ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –∑–∞–∫–∞–∑—á–∏–∫—É ¬´–≤–∞—É, –∫–∞–∫ –ø—Ä–æ–¥—É–º–∞–Ω–æ¬ª.
        </p>

        <div class="fileRow">
          <label for="fridgePhoto">–§–æ—Ç–æ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–∞ / –ø—Ä–æ–¥—É–∫—Ç–æ–≤</label>
          <input id="fridgePhoto" type="file" accept="image/*" />
          <div class="fakeAiBox" id="fakeAiBox"></div>
          <div class="smallNote">–î–µ–º–æ-—Ä–µ–∂–∏–º: ¬´—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ¬ª –∏–º–∏—Ç–∏—Ä—É–µ—Ç—Å—è –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞).</div>
        </div>

        <div class="divider"></div>

        <label for="products">–ü—Ä–æ–¥—É–∫—Ç—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
        <textarea id="products" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: —è–π—Ü–∞, —Ç–≤–æ—Ä–æ–≥, –æ–≤—Å—è–Ω–∫–∞, –æ–≤–æ—â–∏, –∫—É—Ä–∏—Ü–∞"></textarea>

        <div class="twoBtns">
          <button class="btn secondary" id="fillFromPhotoBtn" type="button">–ó–∞–ø–æ–ª–Ω–∏—Ç—å –∏–∑ —Ñ–æ—Ç–æ</button>
          <button class="btn" id="smartMenuBtn" type="button">–°–æ—Å—Ç–∞–≤–∏—Ç—å –º–µ–Ω—é</button>
        </div>

        <div class="menuBox" id="smartMenuBox"></div>

        <div class="finePrint">
          ‚ö†Ô∏è –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–æ—Å–∏—Ç –æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏ –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞.
        </div>
      </div>

    </div>
  </div>

  <script>
    // ===== –£–¢–ò–õ–ò–¢–´ =====
    function byId(id){ return document.getElementById(id); }

    function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

    function round(n){ return Math.round(n); }

    function parseNum(v){
      if(v === null || v === undefined) return NaN;
      const s = String(v).replace(",", ".").trim();
      const n = Number(s);
      return Number.isFinite(n) ? n : NaN;
    }

    function kcalSplit(total){
      // 30/35/15/20
      const breakfast = round(total * 0.30);
      const lunch = round(total * 0.35);
      const snack = round(total * 0.15);
      const dinner = total - breakfast - lunch - snack;
      return { breakfast, lunch, snack, dinner };
    }

    function safeText(s){
      return String(s).replace(/[<>&"]/g, (c)=>({ "<":"&lt;", ">":"&gt;", "&":"&amp;", '"':"&quot;" }[c]));
    }

    // ===== –û–°–ù–û–í–ù–û–ô –†–ê–°–ß–ï–¢ =====
    function calculateDaily(){
      const w = parseNum(byId("weight").value);
      const h = parseNum(byId("height").value);
      const a = parseNum(byId("age").value);

      const warnBox = byId("warnBox");
      warnBox.style.display = "none";

      if(!Number.isFinite(w) || !Number.isFinite(h) || !Number.isFinite(a) || w<=0 || h<=0 || a<=0){
        warnBox.style.display = "block";
        byId("resultWrap").style.display = "none";
        return null;
      }

      const g = byId("gender").value;
      const act = parseNum(byId("activity").value);
      const goal = parseNum(byId("goal").value);

      // Mifflin-St Jeor
      const bmr = (g === "male")
        ? (10*w + 6.25*h - 5*a + 5)
        : (10*w + 6.25*h - 5*a - 161);

      let cal = round(bmr * act * goal);

      // –æ–≥—Ä–∞–Ω–∏—á–∏–º ¬´—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ¬ª
      cal = clamp(cal, 1200, 2800);

      // –º–∞–∫—Ä–æ—Å—ã (–æ—á–µ–Ω—å –º—è–≥–∫–∏–π –æ—Ä–∏–µ–Ω—Ç–∏—Ä)
      const p = round(w * 1.3);     // –±–µ–ª–æ–∫
      const f = round(w * 0.9);     // –∂–∏—Ä—ã
      const c = Math.max(0, round((cal - (p*4 + f*9)) / 4)); // —É–≥–ª–µ–≤–æ–¥—ã

      return { cal, p, f, c };
    }

    function renderResults(model){
      const { cal, p, f, c } = model;

      byId("dailyKcal").textContent = String(cal);
      byId("bjuText").textContent = `–û—Ä–∏–µ–Ω—Ç–∏—Ä –ë–ñ–£: –±–µ–ª–∫–∏ ${p} –≥ ‚Ä¢ –∂–∏—Ä—ã ${f} –≥ ‚Ä¢ —É–≥–ª–µ–≤–æ–¥—ã ${c} –≥`;

      // —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (–ø–æ —Ü–µ–ª–∏)
      const goal = parseNum(byId("goal").value);
      let tone = "–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –π–æ–≥–∏ –∏ –º—è–≥–∫–æ–≥–æ —Å–Ω–∏–∂–µ–Ω–∏—è –≤–µ—Å–∞.";
      if(goal >= 1.0 && goal < 1.04) tone = "–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ –∏ —Ä–æ–≤–Ω–æ–≥–æ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏—è.";
      if(goal >= 1.04) tone = "–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ñ–æ—Ä–º—ã –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –ø—Ä–∞–∫—Ç–∏–∫–∏.";
      byId("toneLine").textContent = tone;

      // —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
      const split = kcalSplit(cal);
      const items = [
        { icon:"ü´ê", title:"–ó–∞–≤—Ç—Ä–∞–∫", kcal: split.breakfast, pct:"~30%" },
        { icon:"üç≤", title:"–û–±–µ–¥", kcal: split.lunch, pct:"~35%" },
        { icon:"üçè", title:"–ü–µ—Ä–µ–∫—É—Å", kcal: split.snack, pct:"~15%" },
        { icon:"ü•ó", title:"–£–∂–∏–Ω", kcal: split.dinner, pct:"~20%" },
      ];

      const ul = byId("mealSplit");
      ul.innerHTML = items.map(x => `
        <li class="mealItem">
          <div class="mealIcon">${x.icon}</div>
          <div class="mealText">
            <div class="mealTitle">${x.title}: ${x.pct} (${x.kcal} –∫–∫–∞–ª)</div>
            <div class="mealSub">–ü–æ—Ä—Ü–∏–∏ –∏ –ø—Ä–æ–¥—É–∫—Ç—ã –±—É–¥—É—Ç –≤ –º–µ–Ω—é –Ω–∏–∂–µ</div>
          </div>
        </li>
      `).join("");

      // –º–µ–Ω—é 1 –¥–µ–Ω—å + –Ω–µ–¥–µ–ª—è
      renderDayMenu(cal);
      renderWeekMenu(cal);

      // –ø–æ–∫–∞–∑–∞—Ç—å –±–ª–æ–∫
      byId("resultWrap").style.display = "block";
      // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ—Ç–∫—Ä—ã—Ç 1 –¥–µ–Ω—å
      showTab("day");
    }

    // ===== –ú–ï–ù–Æ: 1 –î–ï–ù–¨ =====
    function renderDayMenu(totalKcal){
      const split = kcalSplit(totalKcal);

      const day = [
        {
          title: `ü´ê –ó–∞–≤—Ç—Ä–∞–∫ ‚âà ${split.breakfast} –∫–∫–∞–ª`,
          lines: [
            "–û–≤—Å—è–Ω–∫–∞ (—Å—É—Ö–∞—è) ‚Äî 60 –≥",
            "–Ø–≥–æ–¥—ã ‚Äî 100 –≥",
            "–Ø–π—Ü–æ ‚Äî 1‚Äì2 —à—Ç (–ø–æ –≥–æ–ª–æ–¥—É)",
            "–ú—ë–¥ ‚Äî 1 —á.–ª. (–ø–æ –∂–µ–ª–∞–Ω–∏—é)"
          ]
        },
        {
          title: `üç≤ –û–±–µ–¥ ‚âà ${split.lunch} –∫–∫–∞–ª`,
          lines: [
            "–ö—É—Ä–∏—Ü–∞/—Ä—ã–±–∞ ‚Äî 140‚Äì170 –≥",
            "–ì—Ä–µ—á–∫–∞/—Ä–∏—Å (—Å—É—Ö–∞—è) ‚Äî 60‚Äì70 –≥",
            "–°–∞–ª–∞—Ç/–æ–≤–æ—â–∏ ‚Äî 250‚Äì300 –≥",
            "–û–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ ‚Äî 1 —á.–ª."
          ]
        },
        {
          title: `üçè –ü–µ—Ä–µ–∫—É—Å ‚âà ${split.snack} –∫–∫–∞–ª`,
          lines: [
            "–¢–≤–æ—Ä–æ–≥ 5% ‚Äî 180‚Äì220 –≥",
            "–§—Ä—É–∫—Ç (—è–±–ª–æ–∫–æ/–≥—Ä—É—à–∞) ‚Äî 1 —à—Ç",
            "–û—Ä–µ—Ö–∏ ‚Äî 10 –≥ (–µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è)"
          ]
        },
        {
          title: `ü•ó –£–∂–∏–Ω ‚âà ${split.dinner} –∫–∫–∞–ª`,
          lines: [
            "–û–≤–æ—â–∏ ‚Äî 300‚Äì400 –≥",
            "–ë–µ–ª–æ–∫ (—è–π—Ü–∞ 2 —à—Ç / —Ä—ã–±–∞ 140 –≥ / —Ç–≤–æ—Ä–æ–≥ 150 –≥) ‚Äî 1 –≤–∞—Ä–∏–∞–Ω—Ç",
            "–ú–∞—Å–ª–æ ‚Äî 1 —á.–ª. (–µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ –≤ –æ–±–µ–¥)"
          ]
        }
      ];

      byId("dayBox").innerHTML = `
        <div class="menuDay">
          <h4>–¢–≤–æ–π –º—è–≥–∫–∏–π –ø–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</h4>
          <p class="dayHint">–°—Ç—Ä—É–∫—Ç—É—Ä–∞ ¬´–±–µ–ª–æ–∫ + –≥–∞—Ä–Ω–∏—Ä + –æ–≤–æ—â–∏¬ª –¥–∞—ë—Ç —Å—ã—Ç–æ—Å—Ç—å –∏ —Å–Ω–∏–∂–∞–µ—Ç —Ç—è–≥—É –∫ —Å–ª–∞–¥–∫–æ–º—É.</p>

          ${day.map(block => `
            <div class="menuDay" style="margin:0 0 12px; background:#fff;">
              <h4 style="margin:0 0 8px;">${safeText(block.title)}</h4>
              <ul class="menuLines">
                ${block.lines.map(x=>`<li>${safeText(x)}</li>`).join("")}
              </ul>
            </div>
          `).join("")}

          <div class="pill">üí° –ï—Å–ª–∏ –µ—Å—Ç—å —É—Å—Ç–∞–ª–æ—Å—Ç—å: –¥–æ–±–∞–≤—å –≤–æ–¥—ã –∏ –æ–≤–æ—â–µ–π, –∞ —É–∂–∏–Ω —Å–¥–µ–ª–∞–π –ª–µ–≥—á–µ.</div>
        </div>
      `;
    }

    // ===== –ú–ï–ù–Æ: –ù–ï–î–ï–õ–Ø =====
    function renderWeekMenu(totalKcal){
      const split = kcalSplit(totalKcal);
      const B = split.breakfast, L = split.lunch, S = split.snack, D = split.dinner;

      // —à–∞–±–ª–æ–Ω—ã ‚Äî –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –±–µ–∑ ¬´–∫–∞—à–∏¬ª
      const breakfast = [
        "–û–≤—Å—è–Ω–∫–∞ 60 –≥ + —è–≥–æ–¥—ã 100 –≥ + —è–π—Ü–æ 1‚Äì2 —à—Ç",
        "–ô–æ–≥—É—Ä—Ç –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π 250 –≥ + —Ñ—Ä—É–∫—Ç—ã 1 —à—Ç + –æ—Ä–µ—Ö–∏ 10 –≥",
        "–¢–≤–æ—Ä–æ–≥ 200 –≥ + –≥—Ä—É—à–∞/—è–±–ª–æ–∫–æ 1 —à—Ç + –º—ë–¥ 1 —á.–ª.",
        "–û–º–ª–µ—Ç 2 —è–π—Ü–∞ + –æ–≤–æ—â–∏ 250 –≥ + —Ö–ª–µ–± —Ü–µ–ª—å–Ω–æ–∑–µ—Ä–Ω. 1 –ª–æ–º—Ç–∏–∫",
      ];
      const lunch = [
        "–ö—É—Ä–∏—Ü–∞/—Ä—ã–±–∞ 150 –≥ + –≥—Ä–µ—á–∫–∞/—Ä–∏—Å 60‚Äì70 –≥ (—Å—É—Ö–∞—è) + —Å–∞–ª–∞—Ç 300 –≥",
        "–ò–Ω–¥–µ–π–∫–∞ 150 –≥ + –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å 250 –≥ (–∑–∞–ø–µ—á.) + –æ–≤–æ—â–∏ 250 –≥",
        "–†—ã–±–∞ 170 –≥ + –∫–∏–Ω–æ–∞/—Ä–∏—Å 60 –≥ (—Å—É—Ö–∞—è) + –æ–≤–æ—â–∏ 300 –≥",
        "–¢—ë–ø–ª–∞—è —Ç–∞—Ä–µ–ª–∫–∞: —Ñ–∞—Å–æ–ª—å/—á–µ—á–µ–≤–∏—Ü–∞ 200 –≥ + –æ–≤–æ—â–∏ 300 –≥ + –º–∞—Å–ª–æ 1 —á.–ª.",
      ];
      const snack = [
        "–¢–≤–æ—Ä–æ–≥ 180‚Äì220 –≥ + —Ñ—Ä—É–∫—Ç 1 —à—Ç",
        "–ô–æ–≥—É—Ä—Ç 200‚Äì250 –≥ + —è–≥–æ–¥—ã 100 –≥",
        "–Ø–π—Ü–∞ 2 —à—Ç + –æ–≤–æ—â–∏ 200 –≥",
        "–ì–æ—Ä—Å—Ç—å –æ—Ä–µ—Ö–æ–≤ 15 –≥ + —Ñ—Ä—É–∫—Ç 1 —à—Ç",
      ];
      const dinner = [
        "–û–≤–æ—â–∏ 350 –≥ + —Ä—ã–±–∞ 140 –≥",
        "–û–≤–æ—â–∏ 350 –≥ + —è–π—Ü–∞ 2 —à—Ç",
        "–û–≤–æ—â–∏ 350 –≥ + —Ç–≤–æ—Ä–æ–≥ 150 –≥",
        "–û–≤–æ—â–∏ 350 –≥ + –∫—É—Ä–∏—Ü–∞ 120‚Äì140 –≥",
      ];

      const days = [
        { name:"–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", tone:"–±–∞–ª–∞–Ω—Å –∏ —Å—Ç–∞—Ä—Ç" },
        { name:"–í—Ç–æ—Ä–Ω–∏–∫", tone:"–ª—ë–≥–∫–æ—Å—Ç—å" },
        { name:"–°—Ä–µ–¥–∞", tone:"—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è" },
        { name:"–ß–µ—Ç–≤–µ—Ä–≥", tone:"–±–µ–∑ —Å—Ä—ã–≤–æ–≤" },
        { name:"–ü—è—Ç–Ω–∏—Ü–∞", tone:"–ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º—ã" },
        { name:"–°—É–±–±–æ—Ç–∞", tone:"–≤–∫—É—Å–Ω–æ –∏ –ø—Ä–æ—Å—Ç–æ" },
        { name:"–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ", tone:"–º—è–≥–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ" },
      ];

      function pick(arr, i){ return arr[i % arr.length]; }

      const html = `
        <div class="menuDay">
          <h4>–ú–µ–Ω—é –Ω–∞ –Ω–µ–¥–µ–ª—é (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ + –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å)</h4>
          <p class="dayHint">–°—É—Ç–æ—á–Ω–∞—è —Ü–µ–ª—å: ~${totalKcal} –∫–∫–∞–ª. –ú–µ–Ω—è–µ–º ¬´–±–µ–ª–æ–∫/–≥–∞—Ä–Ω–∏—Ä/–æ–≤–æ—â–∏¬ª, –Ω–µ –ª–æ–º–∞—è —Å–∏—Å—Ç–µ–º—É.</p>

          ${days.map((d, i)=>`
            <div class="menuDay" style="margin:0 0 12px; background:#fff;">
              <h4 style="margin:0 0 8px;">${d.name} ‚Äî ${d.tone}</h4>
              <ul class="menuLines">
                <li><b>ü´ê –ó–∞–≤—Ç—Ä–∞–∫ (~${B} –∫–∫–∞–ª):</b> ${safeText(pick(breakfast, i))}</li>
                <li><b>üç≤ –û–±–µ–¥ (~${L} –∫–∫–∞–ª):</b> ${safeText(pick(lunch, i))}</li>
                <li><b>üçè –ü–µ—Ä–µ–∫—É—Å (~${S} –∫–∫–∞–ª):</b> ${safeText(pick(snack, i))}</li>
                <li><b>ü•ó –£–∂–∏–Ω (~${D} –∫–∫–∞–ª):</b> ${safeText(pick(dinner, i))}</li>
              </ul>
              <div class="mini">–ü–æ–¥—Å–∫–∞–∑–∫–∞ –¥–Ω—è: –¥–µ—Ä–∂–∏ –æ–≤–æ—â–∏ –≤ –∫–∞–∂–¥–æ–º –ø—Ä–∏—ë–º–µ ‚Äî —Ç–∞–∫ –ª–µ–≥—á–µ —Å–Ω–∏–∂–∞—Ç—å –≤–µ—Å.</div>
            </div>
          `).join("")}

          <div class="pill">‚ú® –û–≥–æ-—ç—Ñ—Ñ–µ–∫—Ç: —ç—Ç–æ ¬´–≥–æ—Ç–æ–≤–∞—è –Ω–µ–¥–µ–ª—è¬ª, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä—è—Ç—å 3‚Äì4 —Ä–∞–∑–∞ (–ø–æ–ª—É—á–∏—Ç—Å—è –º–µ—Å—è—Ü).</div>
        </div>
      `;

      byId("weekBox").innerHTML = html;
    }

    function showTab(which){
      const tabDay = byId("tabDay");
      const tabWeek = byId("tabWeek");
      const dayBox = byId("dayBox");
      const weekBox = byId("weekBox");

      if(which === "day"){
        tabDay.classList.add("active");
        tabWeek.classList.remove("active");
        dayBox.style.display = "block";
        weekBox.style.display = "none";
      } else {
        tabWeek.classList.add("active");
        tabDay.classList.remove("active");
        weekBox.style.display = "block";
        dayBox.style.display = "none";
      }
    }

    // ===== –£–ú–ù–û–ï –ú–ï–ù–Æ –ò–ó –ü–†–û–î–£–ö–¢–û–í (–î–ï–ú–û) =====
    const demoRecognitions = [
      "—è–π—Ü–∞, —Ç–≤–æ—Ä–æ–≥, –æ–≤—Å—è–Ω–∫–∞, –æ–≤–æ—â–∏, —è–±–ª–æ–∫–∏",
      "–∫—É—Ä–∏—Ü–∞, —Ä–∏—Å, –æ–≥—É—Ä—Ü—ã, –ø–æ–º–∏–¥–æ—Ä—ã, –π–æ–≥—É—Ä—Ç",
      "—Ä—ã–±–∞, –≥—Ä–µ—á–∫–∞, —Å–∞–ª–∞—Ç, —è–≥–æ–¥—ã, —è–π—Ü–∞",
      "—Ç–≤–æ—Ä–æ–≥, –≥—Ä—É—à–∞, –æ—Ä–µ—Ö–∏, –æ–≤–æ—â–∏, –π–æ–≥—É—Ä—Ç",
      "–∏–Ω–¥–µ–π–∫–∞, –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å, –æ–≤–æ—â–∏, —è–±–ª–æ–∫–∏, —è–π—Ü–∞"
    ];

    function simulateRecognition(file){
      // –¥–µ–º–æ: –ø–æ–¥–±–∏—Ä–∞–µ–º ¬´—Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ¬ª –ø–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –∏–ª–∏ —Å–ª—É—á–∞–π–Ω–æ
      const name = (file && file.name ? file.name.toLowerCase() : "");
      let idx = Math.floor(Math.random() * demoRecognitions.length);

      if(name.includes("egg") || name.includes("—è–π")) idx = 0;
      if(name.includes("chick") || name.includes("–∫—É—Ä")) idx = 1;
      if(name.includes("fish") || name.includes("—Ä—ã–±")) idx = 2;
      if(name.includes("curd") || name.includes("—Ç–≤–æ—Ä")) idx = 3;

      return demoRecognitions[idx];
    }

    function buildSmartMenu(list){
      const items = list.split(",").map(x=>x.trim()).filter(Boolean);
      const nice = items.length ? items.join(", ") : "–ø—Ä–æ–¥—É–∫—Ç—ã";

      const out = `
        <div class="menuDay">
          <h4>–ú–µ–Ω—é –∏–∑ —Ç–æ–≥–æ, —á—Ç–æ –µ—Å—Ç—å</h4>
          <p class="dayHint">–ù–∞ –æ—Å–Ω–æ–≤–µ: <b>${safeText(nice)}</b>. –≠—Ç–æ –¥–µ–º–æ-–ª–æ–≥–∏–∫–∞ –¥–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏ –∑–∞–∫–∞–∑—á–∏–∫—É.</p>

          <div class="menuDay" style="margin:0 0 12px; background:#fff;">
            <h4 style="margin:0 0 8px;">ü´ê –ó–∞–≤—Ç—Ä–∞–∫</h4>
            <ul class="menuLines">
              <li>–û—Å–Ω–æ–≤–∞: –æ–≤—Å—è–Ω–∫–∞/–π–æ–≥—É—Ä—Ç/—Ç–≤–æ—Ä–æ–≥ (–≤—ã–±–µ—Ä–∏ 1)</li>
              <li>–§—Ä—É–∫—Ç/—è–≥–æ–¥—ã (—á—Ç–æ –µ—Å—Ç—å)</li>
              <li>–ë–µ–ª–æ–∫: —è–π—Ü–∞ 1‚Äì2 —à—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)</li>
            </ul>
          </div>

          <div class="menuDay" style="margin:0 0 12px; background:#fff;">
            <h4 style="margin:0 0 8px;">üç≤ –û–±–µ–¥</h4>
            <ul class="menuLines">
              <li>–ë–µ–ª–æ–∫: –∫—É—Ä–∏—Ü–∞/—Ä—ã–±–∞/–∏–Ω–¥–µ–π–∫–∞/–±–æ–±–æ–≤—ã–µ (—á—Ç–æ –µ—Å—Ç—å)</li>
              <li>–ì–∞—Ä–Ω–∏—Ä: —Ä–∏—Å/–≥—Ä–µ—á–∫–∞/–∫–∞—Ä—Ç–æ—Ñ–µ–ª—å (—á—Ç–æ –µ—Å—Ç—å)</li>
              <li>–û–≤–æ—â–∏/—Å–∞–ª–∞—Ç ‚Äî –ø–æ–±–æ–ª—å—à–µ</li>
            </ul>
          </div>

          <div class="menuDay" style="margin:0 0 12px; background:#fff;">
            <h4 style="margin:0 0 8px;">üçè –ü–µ—Ä–µ–∫—É—Å</h4>
            <ul class="menuLines">
              <li>–¢–≤–æ—Ä–æ–≥/–π–æ–≥—É—Ä—Ç –∏–ª–∏ —Ñ—Ä—É–∫—Ç</li>
              <li>–û—Ä–µ—Ö–∏ 10‚Äì15 –≥ (–µ—Å–ª–∏ –µ—Å—Ç—å)</li>
            </ul>
          </div>

          <div class="menuDay" style="margin:0; background:#fff;">
            <h4 style="margin:0 0 8px;">ü•ó –£–∂–∏–Ω</h4>
            <ul class="menuLines">
              <li>–û–≤–æ—â–∏</li>
              <li>–õ—ë–≥–∫–∏–π –±–µ–ª–æ–∫: —è–π—Ü–∞/—Ä—ã–±–∞/—Ç–≤–æ—Ä–æ–≥</li>
              <li>–ï—Å–ª–∏ –ø–æ—Å–ª–µ –π–æ–≥–∏ –≥–æ–ª–æ–¥–Ω–æ ‚Äî –¥–æ–±–∞–≤—å –≥–∞—Ä–Ω–∏—Ä –º–∞–ª–µ–Ω—å–∫–æ–π –ø–æ—Ä—Ü–∏–µ–π</li>
            </ul>
          </div>

          <div class="pill">‚ú® –í–∞—É-–¥–µ—Ç–∞–ª—å: –º–µ–Ω—é –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ ¬´—á—Ç–æ –µ—Å—Ç—å¬ª, –∞ –Ω–µ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–∫—É–ø–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã.</div>
        </div>
      `;

      byId("smartMenuBox").style.display = "block";
      byId("smartMenuBox").innerHTML = out;
    }

    // ===== –°–¢–ê–†–¢: –ù–ê–í–ï–®–ò–í–ê–ï–ú –ö–ù–û–ü–ö–ò (—á—Ç–æ–±—ã ¬´–†–∞—Å—Å—á–∏—Ç–∞—Ç—å¬ª –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–ª–∞) =====
    document.addEventListener("DOMContentLoaded", () => {
      const calcBtn = byId("calcBtn");
      const smartBtn = byId("smartMenuBtn");
      const fillBtn = byId("fillFromPhotoBtn");
      const photoInput = byId("fridgePhoto");

      calcBtn.addEventListener("click", () => {
        const model = calculateDaily();
        if(model) renderResults(model);
      });

      byId("tabDay").addEventListener("click", ()=>showTab("day"));
      byId("tabWeek").addEventListener("click", ()=>showTab("week"));

      let recognized = "";

      photoInput.addEventListener("change", (e) => {
        const file = e.target.files && e.target.files[0] ? e.target.files[0] : null;
        recognized = simulateRecognition(file);
        const box = byId("fakeAiBox");
        box.style.display = "block";
        box.textContent = `‚úÖ –î–µ–º–æ-—Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ –Ω–∞ —Ñ–æ—Ç–æ: ${recognized}`;
      });

      fillBtn.addEventListener("click", () => {
        if(!recognized){
          alert("–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ —Ñ–æ—Ç–æ (–¥–ª—è –¥–µ–º–æ-—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è).");
          return;
        }
        byId("products").value = recognized;
      });

      smartBtn.addEventListener("click", () => {
        const list = byId("products").value.trim();
        if(!list){
          alert("–í–≤–µ–¥–∏ –ø—Ä–æ–¥—É–∫—Ç—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é) –∏–ª–∏ –Ω–∞–∂–º–∏ ¬´–ó–∞–ø–æ–ª–Ω–∏—Ç—å –∏–∑ —Ñ–æ—Ç–æ¬ª.");
          return;
        }
        buildSmartMenu(list);
      });
    });
  </script>
</body>
</html>
